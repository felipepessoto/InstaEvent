@model IEnumerable<Instaeventos.Core.InstagramPhoto>

<img id="showPhoto" />

@section scripts{
    
<script>

    var photos = [];
    var currentIndex = 0;

    $.get("/api/InstagramPhoto/").done(function (resultado) {
        photos = resultado;
        trocarPhoto();
        setInterval(trocarPhoto, 5000);
        setInterval(checkNewPhotos, 5000);
    });

    function trocarPhoto() {
        if (photos.length > 0) {
            currentIndex++;
            if (currentIndex > photos.length - 1) {
                currentIndex = 0;
            }

            $('#showPhoto').fadeOut(1000, function () {
                $('#showPhoto').prop('src', photos[currentIndex].ImageUrl);
            }).fadeIn(1000);            
        }
    }

    function checkNewPhotos() {
        $.get("/api/InstagramPhoto/?newPhotos=true").done(function (resultado) {
            if (resultado.length > 0) {
                var newIndex = photos.length - 1;
                photos = photos.concat(resultado);
                currentIndex = newIndex;
            }
        });
    }
</script>
        
}

